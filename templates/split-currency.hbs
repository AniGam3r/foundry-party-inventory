{{!-- Removed the <form> tags to prevent V13 nested form reloads --}}
{{#*inline "actor-row"}}
    <div class="party-inventory__currency-row flexrow flex1" style="margin-bottom: 5px; align-items: center;">
        <input class="party-inventory__actor-included" type="checkbox" data-actor-id="{{actor.id}}" {{ifThen isEnabled "checked" ""}} />
        <div class="party-inventory__actor-name" style="flex: 1.5; font-weight: bold; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
            {{actor.name}}
        </div>
        
        {{#each actor.currency}}
        <div class="party-inventory__currency-entry flexrow" style="align-items: center; gap: 2px;">
            <input value="{{this}}" type="number" name="actors.{{../actor.id}}.{{@key}}" data-dtype="Number" style="width: 45px;" />
            <span class="flex0" style="font-size: 0.8em; text-transform: uppercase;">{{localize (concat "PARTY-INVENTORY." @key)}}</span>
        </div>
        {{/each}}
    </div>
{{/inline}}

{{!-- Active Participants --}}
<div class="party-inventory__participants">
    {{#each actors as |actor|}}
        {{> actor-row actor=actor isEnabled=true}}
    {{/each}}
</div>

{{!-- Hidden/Excluded Section --}}
{{#if (and (not showNonSplitting) nonSplittingActors.length)}}
    <div class="party-inventory__reveal-disabled" style="text-align: center; margin: 10px 0;">
        <a data-action="reveal-disabled" style="cursor: pointer; font-style: italic;">
            <i class="fas fa-eye"></i> {{localize "PARTY-INVENTORY.reveal-disabled" count=nonSplittingActors.length}}
        </a>
    </div>
{{/if}}

{{#if showNonSplitting}}
    <div class="party-inventory__excluded-list" style="opacity: 0.7; border-top: 1px dashed #7a7971; margin-top: 10px; padding-top: 10px;">
        {{#each nonSplittingActors as |actor|}}
            {{> actor-row actor=actor isEnabled=false}}
        {{/each}}
    </div>
{{/if}}

<button class="flex0" type="submit" name="submit" style="margin-top: 10px;">
    <i class="fas fa-hands-helping"></i> {{localize "PARTY-INVENTORY.split-currency"}}
</button>
